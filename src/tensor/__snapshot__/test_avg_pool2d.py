import torch

def test_avg_pool2d():
    a = torch.tensor([[[[0.23193953931331635,-0.9572423696517944,-0.6499392986297607,-0.9692349433898926,-0.3362119793891907],[-0.4338535666465759,-0.8236226439476013,0.6791391968727112,0.6082472801208496,0.3328486680984497],[0.05109986662864685,0.7491360306739807,-0.6769163012504578,-0.01848955824971199,0.3614869713783264],[-0.6127452254295349,-0.26850271224975586,-0.1907285451889038,0.3077051341533661,-0.34001031517982483]],[[0.3663826584815979,-0.14738808572292328,0.3900488317012787,-0.06342953443527222,0.47320351004600525],[-0.15762098133563995,-0.03688250482082367,0.3375449478626251,-0.3398120701313019,-0.6835131049156189],[0.7505687475204468,-0.023452138528227806,0.024893853813409805,0.4261877238750458,0.13734762370586395],[0.2711954414844513,-0.32425403594970703,-0.02062375470995903,-0.6134109497070312,0.6571998596191406]],[[-0.36438438296318054,-0.810602068901062,0.8760115504264832,0.33559539914131165,0.5282369256019592],[0.45072439312934875,-0.7516795992851257,0.7518489360809326,0.676425039768219,0.34842780232429504],[-0.90400230884552,-0.9477491974830627,-0.9462980031967163,-0.4534570574760437,-0.3560742139816284],[-0.6082800626754761,-0.4886247515678406,-0.09143755584955215,0.9139198064804077,0.2639783024787903]]],[[[-0.45535042881965637,-0.5269649028778076,-0.22615283727645874,-0.9469784498214722,0.1851653903722763],[0.019958922639489174,0.33514103293418884,-0.5552229881286621,0.0343792624771595,-0.695143461227417],[0.10260666906833649,0.29081040620803833,-0.8598014712333679,-0.8798351287841797,-0.42887255549430847],[-0.4169297516345978,0.6753455996513367,-0.417716920375824,0.94532710313797,0.41667166352272034]],[[-0.1105073019862175,0.4210078716278076,-0.45518267154693604,-0.34820571541786194,-0.7651030421257019],[-0.9649389386177063,-0.8886757493019104,-0.13860481977462769,-0.768852949142456,0.3825380802154541],[0.6009319424629211,0.8871250748634338,-0.5087488889694214,-0.5200148224830627,-0.05050414055585861],[-0.018569685518741608,-0.30058401823043823,-0.5005064606666565,0.3609837293624878,-0.6083757281303406]],[[0.4932307302951813,-0.9541529417037964,0.58220374584198,0.35814064741134644,0.24016596376895905],[0.556648313999176,-0.14718855917453766,-0.37906908988952637,-0.22143657505512238,0.40061482787132263],[0.6845512986183167,0.5608916282653809,-0.8602480292320251,0.3451920449733734,-0.2965222895145416],[0.30276188254356384,0.020035596564412117,-0.6529751420021057,0.29793062806129456,0.7429209351539612]]]])
    c = torch.nn.functional.avg_pool2d(a, kernel_size=(2, 2), stride=(2, 2))
    assert (c == torch.tensor([[[[-0.49569475650787354,-0.08294694125652313],[-0.0202530175447464,-0.1446073055267334]],[[0.00612277165055275,0.08108804374933243],[0.16851449012756348,-0.045738279819488525]],[[-0.3689854145050049,0.659970223903656],[-0.7371640801429749,-0.14431819319725037]]],[[[-0.15680384635925293,-0.42349374294281006],[0.16295823454856873,-0.303006649017334]],[[-0.385778546333313,-0.427711546421051],[0.29222583770751953,-0.2920716106891632]],[[-0.012865614145994186,0.08495968580245972],[0.3920601010322571,-0.2175251543521881]]]])).all()
