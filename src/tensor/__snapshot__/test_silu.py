import torch

def test_silu():
    a = torch.tensor([[[[-0.2955702543258667,-0.8177422285079956,-0.8997843861579895,-0.1545487642288208,-0.552005410194397],[-0.0948251485824585,0.6609057188034058,0.21990251541137695,0.43133544921875,0.9582411050796509],[0.7228865623474121,-0.5188244581222534,0.2701148986816406,-0.21887880563735962,0.943917989730835],[-0.4507488012313843,-0.5474874973297119,0.41745615005493164,0.39493775367736816,0.997472882270813]],[[-0.9003908038139343,0.18648767471313477,-0.717011570930481,-0.2814409136772156,-0.024237751960754395],[0.23831844329833984,0.49988412857055664,-0.250727117061615,0.4669255018234253,-0.2615886926651001],[-0.43666160106658936,-0.15292900800704956,-0.7877539396286011,0.4956502914428711,-0.5569112300872803],[0.5138841867446899,0.841296911239624,-0.5421080589294434,-0.8985316157341003,0.8813014030456543]],[[0.6578092575073242,0.46230340003967285,-0.5396940112113953,-0.47452419996261597,0.8136246204376221],[0.40152835845947266,-0.9881891012191772,0.7672386169433594,0.30380094051361084,0.4578361511230469],[-0.3085193634033203,-0.24936842918395996,0.5891993045806885,-0.7577323317527771,0.6812231540679932],[-0.9833030104637146,-0.8157637119293213,0.7412015199661255,0.6780390739440918,-0.814010739326477]]],[[[-0.7987383008003235,-0.42950761318206787,0.9249464273452759,0.5993025302886963,0.5422641038894653],[-0.16535788774490356,-0.5273228883743286,-0.06592398881912231,-0.10099834203720093,-0.2077537178993225],[-0.3207924962043762,-0.11896622180938721,-0.9848020076751709,-0.3878411650657654,0.6635102033615112],[0.8932644128799438,-0.8225704431533813,-0.14647972583770752,0.922020435333252,0.37906718254089355]],[[0.16411185264587402,-0.054614126682281494,-0.3278481364250183,-0.26007771492004395,0.5237704515457153],[0.15819060802459717,0.7846956253051758,0.17467117309570312,-0.9811979532241821,0.8407622575759888],[-0.7188071012496948,-0.8642661571502686,0.9390685558319092,0.9759869575500488,-0.7226057052612305],[-0.3567482829093933,0.5033785104751587,0.5915882587432861,0.16688144207000732,-0.27440404891967773]],[[0.03039097785949707,0.6279025077819824,0.3989309072494507,-0.6781611442565918,0.32473480701446533],[0.9541763067245483,-0.4985625147819519,0.8650431632995605,-0.3783159852027893,0.40431857109069824],[0.4027813673019409,0.8798936605453491,0.4876202344894409,0.4455273151397705,0.6076211929321289],[0.9715057611465454,0.29230356216430664,-0.6545597314834595,-0.18756628036499023,-0.10851645469665527]]]], dtype=torch.float32)
    b = torch.torch.nn.functional.silu(a)
    assert torch.allclose(b, torch.tensor([[[[-0.1261022984981537,-0.2504279315471649,-0.26012298464775085,-0.07131490856409073,-0.20170235633850098],[-0.04516630619764328,0.43584340810775757,0.12199205160140991,0.26147231459617615,0.6925874352455139],[0.486677885055542,-0.1935874968767166,0.1531878560781479,-0.09751001000404358,0.6795175075531006],[-0.17542363703250885,-0.2006254345178604,0.2516736388206482,0.23596376180648804,0.7287152409553528]],[[-0.2601860761642456,0.10191313922405243,-0.2352166473865509,-0.12104789167642593,-0.011972016654908657],[0.1332913190126419,0.3111439049243927,-0.1097293570637703,0.286998450756073,-0.1137840747833252],[-0.17140571773052216,-0.0706290528178215,-0.24629217386245728,0.30801522731781006,-0.20286184549331665],[0.3215458393096924,0.5878463387489319,-0.19933168590068817,-0.25999224185943604,0.6231610178947449]],[[0.433343768119812,0.28365111351013184,-0.19874705374240875,-0.18200185894966125,0.5637453198432922],[0.24053749442100525,-0.2680659890174866,0.5239651203155518,0.174798384308815,0.28042498230934143],[-0.1306506097316742,-0.10921812802553177,0.3789620101451874,-0.2418217808008194,0.45234012603759766],[-0.26769134402275085,-0.25016507506370544,0.5019850134849548,0.44974395632743835,-0.2499309927225113]]],[[[-0.2478448897600174,-0.16933076083660126,0.6623068451881409,0.3868478238582611,0.34289470314979553],[-0.07585867494344711,-0.1957114040851593,-0.03187589347362518,-0.047951169312000275,-0.0931251049041748],[-0.1348876655101776,-0.05594903975725174,-0.2678070366382599,-0.15677979588508606,0.43794891238212585],[0.6338276863098145,-0.2510635256767273,-0.06788535416126251,0.6596628427505493,0.2250325083732605]],[[0.08877402544021606,-0.026561573147773743,-0.1372911036014557,-0.11322343349456787,0.32894301414489746],[0.08533835411071777,0.53884357213974,0.09494375437498093,-0.26752769947052,0.5873781442642212],[-0.23552127182483673,-0.25621065497398376,0.6751071214675903,0.7088702917098999,-0.23616160452365875],[-0.14689001441001892,0.3137321174144745,0.3808228075504303,0.09038696438074112,-0.11849486827850342]],[[0.015426374040544033,0.4094010591506958,0.23873251676559448,-0.2283177524805069,0.18850131332874298],[0.6888716816902161,-0.18839608132839203,0.6087422966957092,-0.15379798412322998,0.2424798607826233],[0.2414093315601349,0.6219090223312378,0.3021029829978943,0.2715824246406555,0.3933727443218231],[0.7047492265701294,0.1673613339662552,-0.2238350659608841,-0.08501355350017548,-0.05131715536117554]]]], dtype=torch.float32))
