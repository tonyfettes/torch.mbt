import torch

def test_tanh():
    a = torch.tensor([[[[-0.2955702841281891,-0.8177422285079956,-0.8997843861579895,-0.154548779129982,-0.5520054697990417],[-0.09482517838478088,0.660905659198761,0.21990250051021576,0.4313355088233948,0.9582411050796509],[0.7228865623474121,-0.5188244581222534,0.2701149582862854,-0.21887879073619843,0.9439179301261902],[-0.4507488012313843,-0.5474874377250671,0.41745609045028687,0.39493778347969055,0.997472882270813]],[[-0.9003908038139343,0.18648764491081238,-0.717011570930481,-0.2814409136772156,-0.024237770587205887],[0.23831841349601746,0.49988412857055664,-0.2507270872592926,0.4669255316257477,-0.2615886926651001],[-0.43666160106658936,-0.15292899310588837,-0.7877539396286011,0.4956502616405487,-0.5569111704826355],[0.5138841867446899,0.841296911239624,-0.5421080589294434,-0.8985316157341003,0.8813014030456543]],[[0.6578092575073242,0.4623033404350281,-0.5396940112113953,-0.47452419996261597,0.8136246204376221],[0.40152841806411743,-0.9881891012191772,0.7672386169433594,0.3038009703159332,0.4578361511230469],[-0.3085193634033203,-0.24936839938163757,0.5891993641853333,-0.7577323317527771,0.6812232136726379],[-0.9833030104637146,-0.8157637119293213,0.7412014603614807,0.6780391335487366,-0.814010739326477]]],[[[-0.7987383008003235,-0.42950761318206787,0.9249464273452759,0.5993025898933411,0.5422641038894653],[-0.16535788774490356,-0.5273228883743286,-0.06592397391796112,-0.10099833458662033,-0.20775368809700012],[-0.3207924962043762,-0.1189662367105484,-0.9848020076751709,-0.38784119486808777,0.6635101437568665],[0.8932644128799438,-0.8225705027580261,-0.14647971093654633,0.9220204949378967,0.37906718254089355]],[[0.16411185264587402,-0.0546141155064106,-0.3278481364250183,-0.26007774472236633,0.5237704515457153],[0.15819066762924194,0.784695565700531,0.1746712177991867,-0.9811980128288269,0.8407623171806335],[-0.7188071012496948,-0.8642661571502686,0.939068615436554,0.9759870171546936,-0.7226056456565857],[-0.3567482829093933,0.5033784508705139,0.5915883183479309,0.1668814718723297,-0.2744040787220001]],[[0.030391035601496696,0.6279025673866272,0.3989308774471283,-0.6781611442565918,0.3247348666191101],[0.9541763067245483,-0.4985625147819519,0.8650431036949158,-0.3783159852027893,0.40431860089302063],[0.4027813971042633,0.8798936605453491,0.4876202642917633,0.4455273449420929,0.6076212525367737],[0.9715057611465454,0.29230356216430664,-0.6545597314834595,-0.18756628036499023,-0.10851645469665527]]]], dtype=torch.float32)
    b = torch.tanh(a)
    assert torch.allclose(b, torch.tensor([[[[-0.28725358843803406,-0.6738390922546387,-0.7161927819252014,-0.15332992374897003,-0.5020217299461365],[-0.0945419892668724,0.5789658427238464,0.2164251208305359,0.4064367711544037,0.7434913516044617],[0.6186941862106323,-0.47679221630096436,0.26373183727264404,-0.21544913947582245,0.7370172142982483],[-0.42251431941986084,-0.4986346662044525,0.3947851359844208,0.3756091892719269,0.7605308294296265]],[[-0.7164881825447083,0.18435543775558472,-0.6150548458099365,-0.27423813939094543,-0.0242330189794302],[0.23390676081180573,0.4620260000228882,-0.24560201168060303,0.4357118606567383,-0.2557808756828308],[-0.4108734726905823,-0.15174783766269684,-0.6571347713470459,0.4586893916130066,-0.505682110786438],[0.4729660451412201,0.6864954233169556,-0.49458205699920654,-0.7155820727348328,0.7070707082748413]],[[0.5769036412239075,0.4319596290588379,-0.49275627732276917,-0.4418475329875946,0.671584963798523],[0.38125595450401306,-0.7565889954566956,0.6453208923339844,0.29478713870048523,0.42831894755363464],[-0.2990895211696625,-0.24432484805583954,0.5293195247650146,-0.6397393345832825,0.5923140645027161],[-0.7544921636581421,-0.6727575063705444,0.6298704743385315,0.5902431011199951,-0.6717968583106995]]],[[[-0.6633307933807373,-0.40490972995758057,0.7282291054725647,0.5365530848503113,0.4946998953819275],[-0.1638670265674591,-0.4833320081233978,-0.06582863628864288,-0.10065633803606033,-0.20481540262699127],[-0.3102233409881592,-0.11840817332267761,-0.7551371455192566,-0.3694976568222046,0.5806946754455566],[0.7130022644996643,-0.6764664649963379,-0.1454409956932068,0.7268518805503845,0.3618970811367035]],[[0.16265423595905304,-0.05455988645553589,-0.3165859282016754,-0.25436827540397644,0.4806048274040222],[0.15688419342041016,0.6553936004638672,0.1729162484407425,-0.753584086894989,0.6862125992774963],[-0.616169810295105,-0.6984491944313049,0.7347939610481262,0.751323401927948,-0.6185207366943359],[-0.3423466384410858,0.46477001905441284,0.5310369729995728,0.1653493493795395,-0.26771801710128784]],[[0.030381685122847557,0.5566062927246094,0.37903377413749695,-0.5903226733207703,0.3137819170951843],[0.7416679263114929,-0.46098592877388,0.6988469362258911,-0.3612441122531891,0.38363808393478394],[0.38232630491256714,0.7063660621643066,0.45232564210891724,0.4182155430316925,0.5424504280090332],[0.7493652701377869,0.28425365686416626,-0.5747315287590027,-0.1853971779346466,-0.1080925315618515]]]], dtype=torch.float32))
