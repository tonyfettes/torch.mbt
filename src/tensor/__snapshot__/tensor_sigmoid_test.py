import torch

def test_sigmoid():
    a = torch.tensor([[[[-0.2955702543258667,-0.8177422285079956,-0.8997843861579895,-0.1545487642288208,-0.552005410194397],[-0.0948251485824585,0.6609057188034058,0.21990251541137695,0.43133544921875,0.9582411050796509],[0.7228865623474121,-0.5188244581222534,0.2701148986816406,-0.21887880563735962,0.943917989730835],[-0.4507488012313843,-0.5474874973297119,0.41745615005493164,0.39493775367736816,0.997472882270813]],[[-0.9003908038139343,0.18648767471313477,-0.717011570930481,-0.2814409136772156,-0.024237751960754395],[0.23831844329833984,0.49988412857055664,-0.250727117061615,0.4669255018234253,-0.2615886926651001],[-0.43666160106658936,-0.15292900800704956,-0.7877539396286011,0.4956502914428711,-0.5569112300872803],[0.5138841867446899,0.841296911239624,-0.5421080589294434,-0.8985316157341003,0.8813014030456543]],[[0.6578092575073242,0.46230340003967285,-0.5396940112113953,-0.47452419996261597,0.8136246204376221],[0.40152835845947266,-0.9881891012191772,0.7672386169433594,0.30380094051361084,0.4578361511230469],[-0.3085193634033203,-0.24936842918395996,0.5891993045806885,-0.7577323317527771,0.6812231540679932],[-0.9833030104637146,-0.8157637119293213,0.7412015199661255,0.6780390739440918,-0.814010739326477]]],[[[-0.7987383008003235,-0.42950761318206787,0.9249464273452759,0.5993025302886963,0.5422641038894653],[-0.16535788774490356,-0.5273228883743286,-0.06592398881912231,-0.10099834203720093,-0.2077537178993225],[-0.3207924962043762,-0.11896622180938721,-0.9848020076751709,-0.3878411650657654,0.6635102033615112],[0.8932644128799438,-0.8225704431533813,-0.14647972583770752,0.922020435333252,0.37906718254089355]],[[0.16411185264587402,-0.054614126682281494,-0.3278481364250183,-0.26007771492004395,0.5237704515457153],[0.15819060802459717,0.7846956253051758,0.17467117309570312,-0.9811979532241821,0.8407622575759888],[-0.7188071012496948,-0.8642661571502686,0.9390685558319092,0.9759869575500488,-0.7226057052612305],[-0.3567482829093933,0.5033785104751587,0.5915882587432861,0.16688144207000732,-0.27440404891967773]],[[0.03039097785949707,0.6279025077819824,0.3989309072494507,-0.6781611442565918,0.32473480701446533],[0.9541763067245483,-0.4985625147819519,0.8650431632995605,-0.3783159852027893,0.40431857109069824],[0.4027813673019409,0.8798936605453491,0.4876202344894409,0.4455273151397705,0.6076211929321289],[0.9715057611465454,0.29230356216430664,-0.6545597314834595,-0.18756628036499023,-0.10851645469665527]]]])
    c = torch.sigmoid(a)
    assert torch.allclose(c, torch.tensor([[[[0.42664071917533875,0.3062431216239929,0.28909480571746826,0.4614395201206207,0.36539924144744873],[0.47631147503852844,0.6594638228416443,0.5547551512718201,0.6061924695968628,0.7227694988250732],[0.6732423901557922,0.37312716245651245,0.5671210885047913,0.4454977214336395,0.7198904156684875],[0.3891827166080475,0.3664475083351135,0.6028743982315063,0.597470760345459,0.7305614352226257]],[[0.2889701724052429,0.5464872717857361,0.3280513882637024,0.43010056018829346,0.49394088983535767],[0.5592992305755615,0.6224320530891418,0.4376445412635803,0.6146557927131653,0.43497321009635925],[0.3925367295742035,0.4618420898914337,0.3126511573791504,0.621436595916748,0.3642624318599701],[0.6257165670394897,0.6987382769584656,0.3676973283290863,0.2893523573875427,0.7070918083190918]],[[0.6587681174278259,0.6135604977607727,0.3682587742805481,0.38354599475860596,0.6928813457489014],[0.5990548133850098,0.27126991748809814,0.6829232573509216,0.5753714442253113,0.6125007271766663],[0.4234762191772461,0.43797898292541504,0.6431813836097717,0.3191387951374054,0.6640116572380066],[0.2722368836402893,0.3066636323928833,0.6772584915161133,0.6633009314537048,0.30703648924827576]]],[[[0.3102954924106598,0.39424389600753784,0.7160488963127136,0.6454967260360718,0.6323389410972595],[0.4587544798851013,0.3711414933204651,0.48352497816085815,0.4747718572616577,0.44824761152267456],[0.4204826056957245,0.47029349207878113,0.2719399929046631,0.40423712134361267,0.6600484848022461],[0.7095633745193481,0.30521827936172485,0.46344539523124695,0.7154536247253418,0.5936480760574341]],[[0.5409361124038696,0.48634985089302063,0.4187643229961395,0.4353446066379547,0.6280289888381958],[0.5394653677940369,0.6866912245750427,0.5435571074485779,0.27265414595603943,0.6986257433891296],[0.32765573263168335,0.29644879698753357,0.7189114093780518,0.726311206817627,0.32681944966316223],[0.41174694895744324,0.6232529282569885,0.6437295079231262,0.5416238307952881,0.43182623386383057]],[[0.5075971484184265,0.6520137190818787,0.5984307527542114,0.3366718292236328,0.5804777145385742],[0.7219542860984802,0.3778785467147827,0.7037132382392883,0.4065331220626831,0.5997247695922852],[0.5993557572364807,0.7068002223968506,0.6195456385612488,0.6095752716064453,0.6473979949951172],[0.7254195213317871,0.5725600123405457,0.3419627845287323,0.4532454013824463,0.472897469997406]]]]))
