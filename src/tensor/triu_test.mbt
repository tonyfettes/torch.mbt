test "triu" {
  let a : @tensor.Tensor[Float] = @tensor.tensor([
    [0.2309, 0.5207, 2.0049],
    [0.2072, -1.0680, 0.6602],
    [0.3480, -0.5211, -0.4573],
  ])
  @json.inspect!(a.triu(), content=[
    [0.23090000450611115, 0.5206999778747559, 2.0048999786376953],
    [0, -1.0679999589920044, 0.6601999998092651],
    [0, 0, -0.45730000734329224],
  ])
  @json.inspect!(a.triu(diagonal=1), content=[
    [0, 0.5206999778747559, 2.0048999786376953],
    [0, 0, 0.6601999998092651],
    [0, 0, 0],
  ])
  @json.inspect!(a.triu(diagonal=-1), content=[
    [0.23090000450611115, 0.5206999778747559, 2.0048999786376953],
    [0.20720000565052032, -1.0679999589920044, 0.6601999998092651],
    [0, -0.5210999846458435, -0.45730000734329224],
  ])
  let b : @tensor.Tensor[Float] = @tensor.tensor([
    [0.5876, -0.0794, -1.8373, 0.6654, 0.2604, 1.5235],
    [-0.2447, 0.9556, -1.2919, 1.3378, -0.1768, -1.0857],
    [0.4333, 0.3146, 0.6576, -1.0432, 0.9348, -0.4410],
    [-0.9888, 1.0679, -1.3337, -1.6556, 0.4798, 0.2830],
  ])
  @json.inspect!(@tensor.triu(b, diagonal=1), content=[
    [
      0, -0.07940000295639038, -1.8372999429702759, 0.6654000282287598, 0.2603999972343445,
      1.5234999656677246,
    ],
    [
      0, 0, -1.2919000387191772, 1.3378000259399414, -0.17679999768733978, -1.0857000350952148,
    ],
    [0, 0, 0, -1.0432000160217285, 0.9348000288009644, -0.4410000145435333],
    [0, 0, 0, 0, 0.4797999858856201, 0.28299999237060547],
  ])
  @json.inspect!(@tensor.triu(b, diagonal=-1), content=[
    [
      0.5875999927520752, -0.07940000295639038, -1.8372999429702759, 0.6654000282287598,
      0.2603999972343445, 1.5234999656677246,
    ],
    [
      -0.24469999969005585, 0.9556000232696533, -1.2919000387191772, 1.3378000259399414,
      -0.17679999768733978, -1.0857000350952148,
    ],
    [
      0, 0.31459999084472656, 0.6575999855995178, -1.0432000160217285, 0.9348000288009644,
      -0.4410000145435333,
    ],
    [
      0, 0, -1.3336999416351318, -1.6555999517440796, 0.4797999858856201, 0.28299999237060547,
    ],
  ])
}
