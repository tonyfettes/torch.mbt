test "transpose" {
  let x : @tensor.Tensor[Float] = @tensor.tensor([
    [1.0028, -0.9893, 0.5809],
    [-0.1669, 0.7299, 0.4942],
  ])
  @json.inspect!(x.transpose(0, 1), content=[
    [1.0027999877929688, -0.16689999401569366],
    [-0.989300012588501, 0.7299000024795532],
    [0.5809000134468079, 0.4941999912261963],
  ])
}

test "transpose/higher-dimension" {
  let x = @tensor.tensor([
    [
      [0.8571428656578064, -0.3942857086658478, -0.331428587436676],
      [0.4285714328289032, 0.9028571248054504, 0.03428562730550766],
      [-0.2857142984867096, 0.17142857611179352, -0.9428571462631226],
    ],
  ])
  @json.inspect!(x.transpose(-1, 0), content=[
    [[0.8571428656578064, 0.4285714328289032, -0.2857142984867096]],
    [[-0.3942857086658478, 0.9028571248054504, 0.17142857611179352]],
    [[-0.331428587436676, 0.03428562730550766, -0.9428571462631226]],
  ])
}
