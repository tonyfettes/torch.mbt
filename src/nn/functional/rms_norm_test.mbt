test "rms_norm" {
  let input = @tensor.tensor(
    [
      [[-0.3294, -0.7515, 0.5518], [-0.3660, -0.7684, -0.2903]],
      [[0.7146, 0.2702, 1.5094], [-0.8617, 1.2990, -0.1938]],
    ],
  )
  @json.inspect!(
    @functional.rms_norm(input, [2, 3], @tensor.ones([2, 3])),
    content=[
      [
        [-0.6036717295646667, -1.3772292137145996, 1.0112509727478027],
        [-0.670746386051178, -1.4082008600234985, -0.5320155024528503],
      ],
      [
        [0.7582167983055115, 0.2866921126842499, 1.6015286445617676],
        [-0.9142952561378479, 1.378286600112915, -0.205628901720047],
      ],
    ],
  )
}
