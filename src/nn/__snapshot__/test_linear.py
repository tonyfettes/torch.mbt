import torch

def test_linear(snapshot: torch.Tensor):
    input = torch.tensor([[-0.4301600456237793,0.7356255054473877,0.7850341796875,0.32139527797698975,0.6747739315032959,0.8503944873809814,0.2769254446029663,-0.5336059331893921]], dtype=torch.float32)
    weight = torch.tensor([[-0.10449986159801483,-0.2891155183315277,-0.3181218206882477,-0.0546412467956543,-0.19516339898109436,-0.03352576494216919,0.23366543650627136,0.07774728536605835,0.15250012278556824,0.3387893736362457,0.2555789649486542,-0.18343213200569153,0.09550002217292786,-0.07738533616065979,0.3337254226207733,-0.1593637615442276],[-0.19356605410575867,0.14759305119514465,0.13963156938552856,0.3526599109172821,-0.31833621859550476,0.06593334674835205,-0.25350186228752136,-0.09950438141822815,-0.008569329977035522,0.08425828814506531,0.17673572897911072,-0.08864542841911316,0.16508308053016663,-0.09248557686805725,-0.15438318252563477,-0.054068565368652344],[-0.2785130739212036,0.17523881793022156,-0.19689783453941345,0.18168547749519348,0.29744336009025574,-0.19166414439678192,-0.31767889857292175,0.31158706545829773,0.23257067799568176,0.16344895958900452,-0.1908106505870819,-0.1677696406841278,0.28765973448753357,0.1419617235660553,-0.3493776023387909,0.2712598145008087],[0.10740986466407776,0.16186949610710144,-0.1090780645608902,-0.0881650447845459,0.20831343531608582,-0.267898827791214,0.24084874987602234,-0.34765011072158813,-0.2884160280227661,0.26205429434776306,0.23972299695014954,-0.2877962589263916,-0.2823966145515442,-0.15185387432575226,0.3270179331302643,0.21188542246818542],[0.19171932339668274,-0.058462828397750854,-0.18643678724765778,-0.02330765128135681,-0.03570830821990967,-0.07345202565193176,-0.11341726779937744,-0.042060911655426025,-0.3481800854206085,-0.13712255656719208,0.23458626866340637,0.3158166706562042,-0.2908225655555725,-0.051788389682769775,0.3259834349155426,0.13402047753334045],[0.05802229046821594,-0.019309014081954956,-0.1159118115901947,-0.09195137023925781,0.18518081307411194,0.055928826332092285,0.27743181586265564,0.061755597591400146,-0.3469058573246002,0.297254353761673,-0.25413668155670166,-0.3055642247200012,0.3320108950138092,0.3450634777545929,-0.25547969341278076,-0.12612956762313843],[0.17797115445137024,0.2091580331325531,0.05900150537490845,-0.09701648354530334,0.010744839906692505,0.22199705243110657,0.14104336500167847,-0.2397661656141281,0.11481109261512756,0.3373522460460663,-0.17626845836639404,0.3058389127254486,-0.1337548941373825,0.1429482102394104,0.142404705286026,0.3110893666744232],[0.17239978909492493,0.1575177013874054,0.2148265540599823,0.34347912669181824,0.10334491729736328,-0.2314218282699585,-0.066314697265625,-0.038366347551345825,-0.2295268476009369,0.056703776121139526,-0.3268022835254669,0.3251143991947174,-0.047673553228378296,-0.020641177892684937,-0.011810541152954102,0.28672173619270325]], dtype=torch.float32)
    bias = torch.tensor([-0.2995610237121582,0.2537862956523895,-0.0716765820980072,-0.09333556890487671,-0.16303308308124542,-0.21767345070838928,0.16216638684272766,0.2216375172138214,0.15851262211799622,0.1288575828075409,-0.33302974700927734,0.08836913108825684,0.3518984615802765,-0.21406415104866028,0.21930983662605286,0.24214544892311096], dtype=torch.float32)
    output = torch.nn.functional.linear(input, weight.transpose(-2, -1), bias)
    assert output - torch.tensor([[-0.44512253999710083,0.5943173170089722,-0.34441259503364563,-0.0001831352710723877,0.06840810179710388,-0.20835134387016296,-0.06297078728675842,0.22607934474945068,-0.19918891787528992,0.48106321692466736,-0.31795865297317505,-0.25767046213150024,0.6418187618255615,0.12292376160621643,-0.15854084491729736,0.4682961106300354]]) == snapshot
